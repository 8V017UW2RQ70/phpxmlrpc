<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>4.&nbsp;xmlrpcval</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.67.0"><link rel="start" href="index.html" title="XML-RPC for PHP"><link rel="up" href="ch05.html" title="Chapter&nbsp;5.&nbsp;Class documentation"><link rel="prev" href="ch05s03.html" title="3.&nbsp;xmlrpcresp"><link rel="next" href="ch05s05.html" title="5.&nbsp;xmlrpc_server"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.&nbsp;xmlrpcval</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch05s03.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;5.&nbsp;Class documentation</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch05s05.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xmlrpcval"></a>4.&nbsp;xmlrpcval</h2></div></div></div><p>This is where a lot of the hard work gets done. This class enables the creation and encapsulation of values for XML-RPC.</p><p>Ensure you've read the XML-RPC spec at <a href="http://www.xmlrpc.com/stories/storyReader$7" target="_top">http://www.xmlrpc.com/stories/storyReader$7</a> before reading on as it will make things clearer.</p><p>The <code class="classname">xmlrpcval</code> class can store arbitrarily complicated values using the following types: <code class="literal">i4 int boolean string double dateTime.iso8601 base64 array struct</code>. You should refer to the <a href="http://www.xmlrpc.com/stories/storyReader$7" target="_top">spec</a> for more information on what each of these types mean.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e841"></a>4.1.&nbsp;Notes on types</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e844"></a>4.1.1.&nbsp;int</h4></div></div></div><p>The type <code class="classname">i4</code> is accepted as a synonym for <code class="classname">int</code>. The value parsing code will always convert <code class="classname">i4</code> to <code class="classname">int</code>: <code class="classname">int</code> is regarded by this implementation as the canonical name for this type.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e864"></a>4.1.2.&nbsp;base64</h4></div></div></div><p>Base 64 encoding is performed transparently to the caller when using this type. Therefore you ought to consider it as a "binary" data type, for use when you want to pass none 7-bit clean data. Decoding is also transparent.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e869"></a>4.1.3.&nbsp;boolean</h4></div></div></div><p>The values <code class="literal">true</code> and <code class="literal">1</code> map to <code class="literal">true</code>. All other values (including the empty string) are converted to <code class="literal">false</code>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e886"></a>4.1.4.&nbsp;string</h4></div></div></div><p>Characters &lt;, &gt;, ', ", &amp;, are encoded using their entity reference as &amp;lt;, &amp;gt;, &amp;apos;, &amp;quot; and &amp;amp;. All other non-ASCII characters are encoded using their character reference representation (e.g. &amp;#200 for &eacute;). The current XML-RPC spec recommends only encoding <code class="literal">&lt; &amp;</code> but this implementation goes further, for reasons explained by <a href="http://www.w3.org/TR/REC-xml#syntax" target="_top">the XML 1.0 recommendation</a>. In particular, using character reference representation has the advantage of producing XML that is valid independently of the charset encoding assumed.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="xmlrpcval-creation"></a>4.2.&nbsp;Creation</h3></div></div></div><p>The constructor is the normal way to create an <code class="classname">xmlrpcval</code>. The constructor can take these forms:</p><div class="funcsynopsis"><p><code class="funcdef">$myVal=new xmlrpcval(</code><code>)</code>;<br>;</p><p><code class="funcdef">$myVal=new xmlrpcval(</code><var class="pdparam">$stringVal</var><code>)</code>;<br><code>$stringVal</code>;</p><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" style="padding-bottom: 1em"><tr><td><code class="funcdef">$myVal=new xmlrpcval(</code></td><td><var class="pdparam">$scalarVal</var>, </td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"int" | "boolean" | "string" | "double" | "dateTime.iso8601" | "base64"</var><code>)</code>;</td><td>&nbsp;</td></tr></table><table border="0" summary="Function argument synopsis" cellspacing="0" cellpadding="0" style="padding-bottom: 1em"><tr><td>&nbsp;</td><td><var class="pdparam">$scalarVal</var>;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"int" | "boolean" | "string" | "double" | "dateTime.iso8601" | "base64"</var>;</td></tr></table><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" style="padding-bottom: 1em"><tr><td><code class="funcdef">$myVal=new xmlrpcval(</code></td><td><var class="pdparam">$arrayVal</var>, </td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"array" | "struct"</var><code>)</code>;</td><td>&nbsp;</td></tr></table><table border="0" summary="Function argument synopsis" cellspacing="0" cellpadding="0"><tr><td>&nbsp;</td><td><var class="pdparam">$arrayVal</var>;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"array" | "struct"</var>;</td></tr></table></div><p>The first constructor creates an empty value, which must be altered using the methods <code class="function">addScalar</code>, <code class="function">addArray</code> or <code class="function">addStruct</code> before it can be used.</p><p>The second constructor creates a simple string value.</p><p>The third constructor is used to create a scalar value. The second parameter must be a name of an XML-RPC type. Examples:</p><pre class="programlisting">
                  $myInt=new xmlrpcvalue(1267, "int");
                  $myString=new xmlrpcvalue("Hello, World!", "string");
                  $myBool=new xmlrpcvalue(1, "boolean");
                </pre><p>The fourth constructor form can be used to compose complex XML-RPC values. The first argument is either a simple array in the case of an XML-RPC <code class="classname">array</code> or an associative array in the case of a <code class="classname">struct</code>. The elements of the array <span class="emphasis"><em>must be <code class="classname">xmlrpcval</code> objects themselves</em></span>. Examples:</p><pre class="programlisting">
                  $myArray=new xmlrpcval(array(
                      new xmlrpcval("Tom"), new xmlrpcval("Dick"),
                      new xmlrpcval("Harry")), "array");

                  $myStruct=new xmlrpcval(array(
                      "name" =&gt; new xmlrpcval("Tom"),
                      "age" =&gt; new xmlrpcval(34, "int"),
                      "geek" =&gt; new xmlrpcval(1, "boolean")), "struct");
                </pre><p>See the file <code class="literal">vardemo.php</code> in this distribution for more examples.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="xmlrpcval-methods"></a>4.3.&nbsp;Methods</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e980"></a>4.3.1.&nbsp;addScalar</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$ok=$val-&gt;addScalar(</code><var class="pdparam">$stringVal</var><code>)</code>;<br><code>$stringVal</code>;</p><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" style="padding-bottom: 1em"><tr><td><code class="funcdef">$ok=$val-&gt;addScalar(</code></td><td><var class="pdparam">$scalarVal</var>, </td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"int" | "boolean" | "string" | "double" | "dateTime.iso8601" | "base64"</var><code>)</code>;</td><td>&nbsp;</td></tr></table><table border="0" summary="Function argument synopsis" cellspacing="0" cellpadding="0"><tr><td>&nbsp;</td><td><var class="pdparam">$scalarVal</var>;</td></tr><tr><td>&nbsp;</td><td><var class="pdparam">"int" | "boolean" | "string" | "double" | "dateTime.iso8601" | "base64"</var>;</td></tr></table></div><p>If <em class="parameter"><code>$val</code></em> is an empty <code class="classname">xmlrpcval</code> this method makes it a scalar value, and sets that value. If <em class="parameter"><code>$val</code></em> is already a scalar value, then no more scalars can be added and <code class="literal">0</code> is returned. If all went OK, <code class="literal">1</code> is returned.</p><p>There is a special case if <em class="parameter"><code>$val</code></em> is an <code class="classname">array</code>: the scalar value passed is appended to the array.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1027"></a>4.3.2.&nbsp;addArray</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$ok=$val-&gt;addArray(</code><var class="pdparam">$arrayVal</var><code>)</code>;<br><code>$arrayVal</code>;</p></div><p>Turns an empty <code class="classname">xmlrpcval</code> into an <code class="classname">array</code> with contents as specified by <em class="parameter"><code>$arrayVal</code></em>. See the fourth constructor form for more information.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1048"></a>4.3.3.&nbsp;addStruct</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$ok=$val-&gt;addArray(</code><var class="pdparam">$assocArrayVal</var><code>)</code>;<br><code>$assocArrayVal</code>;</p></div><p>Turns an empty <code class="classname">xmlrpcval</code> into a <code class="classname">struct</code> with contents as specified by <em class="parameter"><code>$assocArrayVal</code></em>. See the fourth constructor form for more information.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1069"></a>4.3.4.&nbsp;kindOf</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$kind=$val-&gt;kindOf(</code><code>)</code>;<br>;</p></div><p>Returns a string containing "struct", "array" or "scalar" describing the base type of the value. If it returns "undef" it means that the value hasn't been initialised.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1079"></a>4.3.5.&nbsp;serialize</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$outString=$val-&gt;serialize(</code><code>)</code>;<br>;</p></div><p>Returns a string containing the XML-RPC representation of this value.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1089"></a>4.3.6.&nbsp;scalarval</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$scalarVal=$val-&gt;scalarval(</code><code>)</code>;<br>;</p></div><p>If <code class="function">$val-&gt;kindOf()=="scalar"</code>, this method returns the actual PHP-language value of the scalar (base 64 decoding is automatically handled here).</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1102"></a>4.3.7.&nbsp;scalartyp</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$typeName=$val-&gt;scalartyp(</code><code>)</code>;<br>;</p></div><p>If <code class="function">$val-&gt;kindOf()=="scalar"</code>, this method returns a string denoting the type of the scalar. As mentioned before, <code class="literal">i4</code> is always coerced to <code class="literal">int</code>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1121"></a>4.3.8.&nbsp;arraymem</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$xmlrpcVal=$val-&gt;arraymem(</code><var class="pdparam">$n</var><code>)</code>;<br><code>$n</code>;</p></div><p>Returns the <em class="parameter"><code>$n</code></em>th element in the array represented by the value <em class="parameter"><code>$val</code></em>. The value returned is an <code class="classname">xmlrpcval</code> object.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1142"></a>4.3.9.&nbsp;arraysize</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$len=$val-&gt;arraysize(</code><code>)</code>;<br>;</p></div><p>If <em class="parameter"><code>$val</code></em> is an <code class="classname">array</code>, returns the number of elements in that array.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1158"></a>4.3.10.&nbsp;structmem</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$xmlrpcVal=$val-&gt;structmem(</code><var class="pdparam">$memberName</var><code>)</code>;<br><code>$memberName</code>;</p></div><p>Returns the element called <em class="parameter"><code>$memberName</code></em> from the struct represented by the value <em class="parameter"><code>$val</code></em>. The value returned is an <code class="classname">xmlrpcval</code> object.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1179"></a>4.3.11.&nbsp;structeach</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">list($key,$value)=$val-&gt;structeach(</code><code>)</code>;<br>;</p></div><p>Returns the next (key,value) pair from the struct, when <em class="parameter"><code>$val</code></em> is a struct. See also <a href="ch05s04.html#structreset">structreset()</a>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="structreset"></a>4.3.12.&nbsp;structreset</h4></div></div></div><div class="funcsynopsis"><p><code class="funcdef">$val-&gt;structreset(</code><code>)</code>;<br>;</p></div><p>Resets the internal pointer for <code class="function">structeach()</code> to the beginning of the struct, where <em class="parameter"><code>$val</code></em> is a struct.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch05s03.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch05.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch05s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3.&nbsp;xmlrpcresp&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;5.&nbsp;xmlrpc_server</td></tr></table></div></body></html>